<!-- generated by pants! -->

<style>
.codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f0f0f0; }
.codehilite .c { color: #60a0b0; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #007020; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #007020 } /* Comment.Preproc */
.codehilite .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #808080 } /* Generic.Output */
.codehilite .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0040D0 } /* Generic.Traceback */
.codehilite .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #007020 } /* Keyword.Pseudo */
.codehilite .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #902000 } /* Keyword.Type */
.codehilite .m { color: #40a070 } /* Literal.Number */
.codehilite .s { color: #4070a0 } /* Literal.String */
.codehilite .na { color: #4070a0 } /* Name.Attribute */
.codehilite .nb { color: #007020 } /* Name.Builtin */
.codehilite .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.codehilite .no { color: #60add5 } /* Name.Constant */
.codehilite .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.codehilite .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #007020 } /* Name.Exception */
.codehilite .nf { color: #06287e } /* Name.Function */
.codehilite .nl { color: #002070; font-weight: bold } /* Name.Label */
.codehilite .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #062873; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #bb60d5 } /* Name.Variable */
.codehilite .ow { color: #007020; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mf { color: #40a070 } /* Literal.Number.Float */
.codehilite .mh { color: #40a070 } /* Literal.Number.Hex */
.codehilite .mi { color: #40a070 } /* Literal.Number.Integer */
.codehilite .mo { color: #40a070 } /* Literal.Number.Oct */
.codehilite .sb { color: #4070a0 } /* Literal.String.Backtick */
.codehilite .sc { color: #4070a0 } /* Literal.String.Char */
.codehilite .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #4070a0 } /* Literal.String.Double */
.codehilite .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #4070a0 } /* Literal.String.Heredoc */
.codehilite .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.codehilite .sx { color: #c65d09 } /* Literal.String.Other */
.codehilite .sr { color: #235388 } /* Literal.String.Regex */
.codehilite .s1 { color: #4070a0 } /* Literal.String.Single */
.codehilite .ss { color: #517918 } /* Literal.String.Symbol */
.codehilite .bp { color: #007020 } /* Name.Builtin.Pseudo */
.codehilite .vc { color: #bb60d5 } /* Name.Variable.Class */
.codehilite .vg { color: #bb60d5 } /* Name.Variable.Global */
.codehilite .vi { color: #bb60d5 } /* Name.Variable.Instance */
.codehilite .il { color: #40a070 } /* Literal.Number.Integer.Long */
</style>

<h1 id="invoking-pants">Invoking Pants</h1>
<p>This page discusses advanced usage when invoking Pants on the command line.
We assume you already know the <a href="first_tutorial.html">basic command-line structure</a>.</p>
<ul>
<li>For details on how to specify target addresses, see <a href="target_addresses.html">Target Addresses</a>.</li>
<li>For details on how to specify options, see <a href="options.html">Options</a>.</li>
<li>For a list of Pants' goals and their options, see the <a href="options_reference.html">Options Reference</a>.</li>
</ul>
<h2 id="order-of-arguments">Order of Arguments</h2>
<p>A simple Pants command line looks like <code>./pants goal target</code>. E.g., <code>./pants compile src/java/::</code>.</p>
<p>The full command line specification is:</p>
<div class="codehilite"><pre>./pants &lt;global and fully-qualified flags&gt; <span class="se">\</span>
        &lt;goal1.task1&gt; &lt;shorthand flags <span class="k">for </span>task1&gt; <span class="se">\</span>
        &lt;goal2.task2&gt; &lt;shorthand flags <span class="k">for </span>task2&gt; <span class="se">\</span>
        ... <span class="se">\</span>
        &lt;target1&gt; &lt;target2&gt; ... <span class="o">[</span>-- passthrough options <span class="k">for </span>last goal<span class="o">]</span>
</pre></div>


<p>Fully qualified flags can be passed anywhere on the command line
before the <code>--</code> separator for passthrough args, but
shorthand flags must immediately follow the goal they apply to.</p>
<p>Consider the following command:</p>
<div class="codehilite"><pre>./pants --level<span class="o">=</span>debug compile.zinc --no-delete-scratch --resolve-ivy-open src::
</pre></div>


<ul>
<li><code>--level</code> is a global flag.</li>
<li>The goal and task to run are <code>compile.zinc</code>.</li>
<li>The <code>--no-delete-scratch</code> is shorthand for the
  <code>--compile-zinc-no-delete-scratch</code> flag.</li>
<li>The <code>--resolve-ivy-open</code> command is a fully qualified flag and
  applies to the <code>resolve.ivy</code> task.  Although the task <code>resolve.ivy</code>
  isn't specified on the command line it implicitly runs because
  <code>compile.zinc</code> task depends on it.</li>
</ul>
<p>You can pass options to pants using the a config file, the
environment, or command line flags. See the
<a href="options.html">Options</a> page for more details.</p>
<h2 id="how-to-use-shorthand-flags">How to Use Shorthand Flags</h2>
<p>Either fully qualified or shorthand flags can be used to pass an
option to a task. The fully qualified (or long form) options are
listed in the <code>help</code> output and the <a href="options_reference.html">Options Reference</a>.
The long form is more foolproof to use because it can go almost anywhere on
the command line, but the shorthand version can save typing.</p>
<p>For many goals, there is only a single task registered. For example,
to specify the <code>--list-sep</code> option for the <code>list</code> goal you could use
the long form:</p>
<div class="codehilite"><pre>./pants list --list-sep<span class="o">=</span><span class="s1">&#39;|&#39;</span> examples/src/python/example:
</pre></div>


<p>or you could use the short form:</p>
<div class="codehilite"><pre>./pants list --sep<span class="o">=</span><span class="s1">&#39;|&#39;</span> examples/src/python/example:
</pre></div>


<p>When a goal has multiple tasks registered, you must fully specify the
task and goal name to use the short form flag.  Here's an example of
using the long form to pass an option to the <code>zinc</code> task:</p>
<div class="codehilite"><pre>./pants --no-compile-zinc-delete-scratch compile src::
</pre></div>


<p>To use the shorthand form of the option, specify both goal and task
name as <code>compile.zinc</code>:</p>
<div class="codehilite"><pre>./pants  compile.zinc --no-delete-scratch src::
</pre></div>


<p>This is especially handy if you have lots of options to type:</p>
<div class="codehilite"><pre>./pants publish.jar --named-snapshot<span class="o">=</span>1.2.3-SNAPSHOT --no-dryrun --force src/java::
</pre></div>


<p>You can use shorthand even when you want to pass options to multiple
tasks by listing each task.  For example:</p>
<div class="codehilite"><pre>./pants compile --compile-zinc-no-delete-scratch --resolve-ivy-open src::
</pre></div>


<p>can also be expressed using shorthand flags:</p>
<div class="codehilite"><pre>./pants --level<span class="o">=</span>debug compile.zinc --no-delete-scratch resolve.ivy --open src::
</pre></div>


<h2 id="passthrough-args">Passthrough Args</h2>
<p>In some cases Pants allows you to pass arguments directly through to the underlying tool it invokes.
These are specified last on the command line after a double-hyphen, and are passed through the
last goal specified.</p>
<p>E.g., to pass <code>-k foo</code> to <code>pytest</code> (to say "only run tests whose names contain <code>foo</code>"):</p>
<div class="codehilite"><pre>./pants test.pytest tests/python/pants_test/tasks -- -k foo
</pre></div>


<p>You can use <code>test</code> instead of <code>test.pytest</code> above; Pants then applies the passthrough args
through all tasks in <code>test</code> that support them. In this case, it would pass them to JUnit as well.
So it only makes sense to do this if you know that JUnit won't be invoked in practice (because
you're not invoking Pants on any Java tests).</p>
<h2 id="the-pants-daemon-pantsd">The Pants Daemon (pantsd)</h2>
<p>The <code>1.3.0</code> release of pants included an alpha release of a daemon (<code>pantsd</code>) to accelerate common
graph operations including build file parsing and source fingerprinting. As of the <code>1.4.0</code> release,
we now consider the daemon to be of late beta quality: it's nearly ready to be enabled by default!</p>
<h3 id="benefits">Benefits</h3>
<p>The daemon caches many filesystem operations run over run, and uses watchman to invalidate that
cache. This can significantly improve the performance of incremental and noop builds (ie,
cases where relatively small portions of the repo have changed since the previous build).</p>
<h3 id="caveats">Caveats</h3>
<p>As of <code>1.4.0</code>, there is one remaining set of caveats to using the daemon:</p>
<ul>
<li>Although <code>./pants repl</code> works, it is missing some advanced TTY integrations which prevent
  line editing and some control sequences from being propagated. See the
  <a href="https://github.com/pantsbuild/pants/milestone/11">Daemon Beta milestone</a> for a summary.</li>
</ul>
<h3 id="usage">Usage</h3>
<p>To enable the daemon, see the example in <code>pants.daemon.ini</code> in the root of the pantsbuild repo:</p>
<p>
<div class="md-included-snippet"><div class="codehilite"><pre><span class="c"># A config override that enables use of pantsd. This is currently recommended for beta testers.</span>
<span class="c">#</span>
<span class="c"># Usage:</span>
<span class="c">#</span>
<span class="c">#    In a shell that you want to use the daemon in:</span>
<span class="c">#</span>
<span class="c">#      $ export PANTS_CONFIG_FILES=&quot;$(pwd)/pants.daemon.ini&quot;</span>
<span class="c">#</span>
<span class="c">#    And then use pants as you normally would:</span>
<span class="c">#</span>
<span class="c">#      $ ./pants ...</span>
<span class="c">#</span>
<span class="c">#    To kill the daemon, you can run either <code>clean-all</code> or <code>kill-pantsd</code>:</span>
<span class="c">#</span>
<span class="c">#      $ ./pants clean-all</span>
<span class="c">#      $ ./pants kill-pantsd</span>
<span class="c">#</span>
<span class="c">#</span>
<span class="c"># Observation Tools:</span>
<span class="c">#</span>
<span class="c">#  To see what&#39;s going on with the daemon, you can tail the pantsd log file in another window:</span>
<span class="c">#</span>
<span class="c">#    $ cd $SOURCE</span>
<span class="c">#    $ tail -F .pants.d/pantsd/pantsd.log</span>
<span class="c">#</span>
<span class="c">#  To see what&#39;s going on with the client, runner and daemon processes you can watch the process table:</span>
<span class="c">#</span>
<span class="c">#    $ watch -n.1 &quot;ps -ef | grep -v grep | grep pants&quot;</span>
<span class="c">#</span>

<span class="k">[GLOBAL]</span>
<span class="err">enable_pantsd:</span> <span class="err">True</span>
</pre></div></div>
</p>
<h3 id="rollout">Rollout</h3>
<p>The daemon will be in beta until the caveat mentioned above is addressed, but we hope to
enable the daemon by default for the <a href="https://github.com/pantsbuild/pants/milestone/12"><code>1.5.0</code> release of pants</a>.</p>
<h2 id="profiling-pants">Profiling Pants</h2>
<p>There are three environment variables that profile various parts of a pants run.</p>
<ul>
<li><code>PANTS_PROFILE</code> - Covers the entire run when pantsd is disabled, or the post-fork portion
  of a pantsd run.</li>
<li><code>PANTSC_PROFILE</code> - Covers the client in a pantsd run, which connects to pantsd and then
  communicates on the socket until the run completes.</li>
<li><code>PANTSD_PROFILE</code> - Covers the graph warming operations pre-fork in a pantsd run.</li>
</ul>
<p>To enable profiling, set the relevant environment variable to a path to write a profile to, and
then run pants:</p>
<div class="codehilite"><pre><span class="nv">PANTS_PROFILE</span><span class="o">=</span>myprofile.prof ./pants ..
</pre></div>


<p>Once you have a profile file, you can use any visualizer that supports python profiles, such as
<code>snakeviz</code> or <code>gprof2dot</code>.</p>
